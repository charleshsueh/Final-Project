"0","stat_features <- data.frame()"
"0","for (start in seq(1, n - window_size + 1, by = step_size)) {"
"0","  end <- start + window_size - 1"
"0","  window_data <- data[start:end, channels]"
"0","  "
"0","  stat_window <- window_data %>%"
"0","    summarise_all(list("
"0","      skewness = ~ psych::skew(., na.rm = TRUE),"
"0","      kurtosis = ~ psych::kurtosi(., na.rm = TRUE)"
"0","    )) %>%"
"0","    pivot_longer(everything(), names_to = c(""Statistic"", ""Channel""), names_sep = ""_"") %>%"
"0","    pivot_wider(names_from = Statistic, values_from = value)"
"0","  "
"0","  stat_window$window_start <- start"
"0","  stat_features <- rbind(stat_features, stat_window)"
"0","}"
"0",""
"0","# 檢查 stat_features 和 feature_data 的結構"
"0","print(""Structure of stat_features before filtering:"")"
"1","[1]"
"1"," ""Structure of stat_features before filtering:"""
"1","
"
"0","str(stat_features)"
"1","tibble [1,856 × 16]"
"1",""
"1"," (S3: "
"1",""
"1","tbl_df/tbl/data.frame"
"1",""
"1",")"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Channel     "
"1",""
"1",":"
"1"," chr [1:1856] "
"1",""
"1","""skewness"" ""kurtosis"" ""skewness"" ""kurtosis"""
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","AF3         "
"1",""
"1",":"
"1"," num [1:1856] "
"1",""
"1","0.19263 -0.19942 -0.00297 -0.2643 3.07605"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","F7          "
"1",""
"1",":"
"1"," num [1:1856] "
"1",""
"1","0.7638 -0.2621 0.2958 -0.0204 3.1115"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","F3          "
"1",""
"1",":"
"1"," num [1:1856] "
"1",""
"1","0.465 -0.629 -0.428 -0.126 -0.344"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","FC5         "
"1",""
"1",":"
"1"," num [1:1856] "
"1",""
"1","0.572 -0.187 -0.271 -0.597 0.989"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","T7          "
"1",""
"1",":"
"1"," num [1:1856] "
"1",""
"1","0.07077 -0.59119 0.00929 -0.58191 0.05575"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","P7          "
"1",""
"1",":"
"1"," num [1:1856] "
"1",""
"1","-0.0604 -1.5427 -0.363 -1.1256 -0.44"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","O1          "
"1",""
"1",":"
"1"," num [1:1856] "
"1",""
"1","0.146 0.754 -0.358 0.777 -0.716"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","O2          "
"1",""
"1",":"
"1"," num [1:1856] "
"1",""
"1","-0.432 0.877 -0.527 0.869 -0.746"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","P8          "
"1",""
"1",":"
"1"," num [1:1856] "
"1",""
"1","-0.30372 -0.00691 -0.2691 -0.09325 -0.5846"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","T8          "
"1",""
"1",":"
"1"," num [1:1856] "
"1",""
"1","0.0696 -0.9948 0.0602 -0.943 -0.2292"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","FC6         "
"1",""
"1",":"
"1"," num [1:1856] "
"1",""
"1","-0.183 -0.83 -0.31 -0.549 1.053"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","F4          "
"1",""
"1",":"
"1"," num [1:1856] "
"1",""
"1","0.0522 -1.1707 -0.1024 -1.0189 1.2254"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","F8          "
"1",""
"1",":"
"1"," num [1:1856] "
"1",""
"1","-0.128 -1.204 0.045 -1.169 2.313"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","AF4         "
"1",""
"1",":"
"1"," num [1:1856] "
"1",""
"1","0.25 -0.574 0.329 -0.473 2.918"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","window_start"
"1",""
"1",":"
"1"," num [1:1856] "
"1",""
"1","1 1 17 17 33 33 49 49 65 65"
"1",""
"1"," ..."
"1",""
"1","
"
"0","print(""Structure of feature_data:"")"
"1","[1]"
"1"," ""Structure of feature_data:"""
"1","
"
"0","str(feature_data)"
"1","'data.frame':	"
"1",""
"1","12992"
"1",""
"1"," obs. of  "
"1",""
"1","7"
"1",""
"1"," variable"
"1",""
"1","s"
"1",""
"1",":"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","delta_power "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.0867 0.1565 0.2416 0.1431 0.2812"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","theta_power "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.0879 0.1081 0.2348 0.0912 0.1008"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","alpha_power "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.1017 0.1493 0.1741 0.0603 0.0895"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","beta_power  "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.0195 0.0211 0.0405 0.0224 0.0237"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","gamma_power "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.0046 0.00576 0.00942 0.00603 0.01238"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","channel     "
"1",""
"1",":"
"1"," chr  "
"1",""
"1","""AF3"" ""F7"" ""F3"" ""FC5"""
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","window_start"
"1",""
"1",":"
"1"," num  "
"1",""
"1","1 1 1 1 1 1 1 1 1 1"
"1",""
"1"," ..."
"1",""
"1","
"
"0","stat_features <- stat_features %>%"
"0","  dplyr::filter(window_start %in% feature_data$window_start) %>%"
"0","  dplyr::select(-window_start) %>%"
"0","  na.omit()"
"0",""
"0","if (nrow(data_features) != nrow(stat_features)) {"
"0","  min_rows <- min(nrow(data_features), nrow(stat_features))"
"0","  data_features <- data_features[1:min_rows, ]"
"0","  stat_features <- stat_features[1:min_rows, ]"
"0","}"
"0",""
"0","data_features <- cbind(data_features, stat_features[names(stat_features) != ""Channel""])"
