"0",""
"0","# Subset data with selected variables"
"0","selected_channels <- gsub(""Channel"", ""Channel"", selected_vars[selected_vars != ""(Intercept)""])"
"0","data_selected <- data[, c(selected_channels, ""eyeDetection"", ""eyeDetection_numeric"")]"
"0",""
"0","# 3. Linear Regression Modeling (Logistic Regression)"
"0","log_model <- glm(eyeDetection ~ ., data = data_selected[, c(selected_channels, ""eyeDetection"")], family = binomial)"
"2","警告： glm.fit:擬合機率算出來是數值零或一"
"0","summary(log_model)"
"1","
Call:
"
"1",""
"1","glm(formula = eyeDetection ~ ., family = binomial, data = data_selected[, 
    c(selected_channels, ""eyeDetection"")])"
"1",""
"1","
"
"1","
Coefficients:
"
"1","           "
"1","   Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)"
"1"," -1.027e+00"
"1","  1.436e-01"
"1","  -7.150"
"1"," 8.67e-13"
"1"," ***"
"1","
Channel1   "
"1","  1.608e+01"
"1","  4.982e+00"
"1","   3.228"
"1","  0.00125"
"1"," ** "
"1","
Channel2   "
"1"," -9.101e-01"
"1","  4.892e-02"
"1"," -18.603"
"1","  < 2e-16"
"1"," ***"
"1","
Channel3   "
"1","  6.242e-01"
"1","  9.287e-02"
"1","   6.721"
"1"," 1.80e-11"
"1"," ***"
"1","
Channel4   "
"1"," -5.658e+01"
"1","  9.246e+00"
"1","  -6.120"
"1"," 9.38e-10"
"1"," ***"
"1","
Channel5   "
"1","  1.326e+00"
"1","  8.554e-02"
"1","  15.507"
"1","  < 2e-16"
"1"," ***"
"1","
Channel6   "
"1"," -1.204e+02"
"1","  6.287e+00"
"1"," -19.148"
"1","  < 2e-16"
"1"," ***"
"1","
Channel7   "
"1","  1.724e+01"
"1","  6.142e+00"
"1","   2.807"
"1","  0.00500"
"1"," ** "
"1","
Channel8   "
"1"," -5.565e-03"
"1","  6.269e-02"
"1","  -0.089"
"1","  0.92927"
"1","    "
"1","
Channel9   "
"1","  1.207e+01"
"1","  5.370e+00"
"1","   2.247"
"1","  0.02462"
"1"," *  "
"1","
Channel10  "
"1","  1.820e-01"
"1","  8.146e-02"
"1","   2.234"
"1","  0.02548"
"1"," *  "
"1","
Channel11  "
"1"," -3.675e-01"
"1","  6.263e-02"
"1","  -5.868"
"1"," 4.41e-09"
"1"," ***"
"1","
Channel12  "
"1","  2.569e-01"
"1","  1.163e-01"
"1","   2.210"
"1","  0.02712"
"1"," *  "
"1","
Channel13  "
"1"," -1.862e+00"
"1","  1.705e+00"
"1","  -1.092"
"1","  0.27484"
"1","    "
"1","
Channel14  "
"1","  3.064e+01"
"1","  1.235e+01"
"1","   2.481"
"1","  0.01309"
"1"," *  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 20609  on 14979  degrees of freedom
"
"1",""
"1","Residual deviance: 19156  on 14965  degrees of freedom
"
"1","AIC: "
"1",""
"1","19186"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","10"
"1",""
"1","
"
"1","
"
"0","# 4. Bayesian Inference (Adjusted)"
"0","bayes_model <- brm(eyeDetection ~ ., data = data_selected[, c(selected_channels, ""eyeDetection"")], "
"0","                   family = bernoulli(), chains = 2, iter = 2000, warmup = 1000, "
"0","                   control = list(adapt_delta = 0.95, max_treedepth = 12))"
"2","Compiling Stan program...
"
"2","Start sampling
"
"1","
"
"1",""
"1","SAMPLING"
"1",""
"1"," FOR MODEL '"
"1",""
"1","anon_model"
"1",""
"1","' NOW (CHAIN "
"1",""
"1","1"
"1",""
"1",").
"
"1","Chain "
"1","1"
"1",": "
"1",""
"1","
"
"1","Chain "
"1","1"
"1",": "
"1","Gradient evaluation took 0.000645 seconds"
"1","
"
"1","Chain "
"1","1"
"1",": "
"1","1000 transitions using 10 leapfrog steps per transition would take 6.45 seconds."
"1","
"
"1","Chain "
"1","1"
"1",": "
"1","Adjust your expectations accordingly!"
"1","
"
"1","Chain "
"1","1"
"1",": "
"1",""
"1","
"
"1","Chain "
"1","1"
"1",": "
"1",""
"1","
"
"1","Chain "
"1","1"
"1",": "
"1","Iteration:    1 / 2000 [  0%]  (Warmup)"
"1","
"
"1","Chain "
"1","1"
"1",": "
"1","Iteration:  200 / 2000 [ 10%]  (Warmup)"
"1","
"
"1","Chain "
"1","1"
"1",": "
"1","Iteration:  400 / 2000 [ 20%]  (Warmup)"
"1","
"
"1","Chain "
"1","1"
"1",": "
"1","Iteration:  600 / 2000 [ 30%]  (Warmup)"
"1","
"
"1","Chain "
"1","1"
"1",": "
"1","Iteration:  800 / 2000 [ 40%]  (Warmup)"
"1","
"
"1","Chain "
"1","1"
"1",": "
"1","Iteration: 1000 / 2000 [ 50%]  (Warmup)"
"1","
"
"1","Chain "
"1","1"
"1",": "
"1","Iteration: 1001 / 2000 [ 50%]  (Sampling)"
"1","
"
"1","Chain "
"1","1"
"1",": "
"1","Iteration: 1200 / 2000 [ 60%]  (Sampling)"
"1","
"
"1","Chain "
"1","1"
"1",": "
"1","Iteration: 1400 / 2000 [ 70%]  (Sampling)"
"1","
"
"1","Chain "
"1","1"
"1",": "
"1","Iteration: 1600 / 2000 [ 80%]  (Sampling)"
"1","
"
"1","Chain "
"1","1"
"1",": "
"1","Iteration: 1800 / 2000 [ 90%]  (Sampling)"
"1","
"
"1","Chain "
"1","1"
"1",": "
"1","Iteration: 2000 / 2000 [100%]  (Sampling)"
"1","
"
"1","Chain "
"1","1"
"1",": "
"1",""
"1","
"
"1","Chain "
"1","1"
"1",": "
"1"," Elapsed Time: 136.951 seconds (Warm-up)"
"1","
"
"1","Chain "
"1","1"
"1",": "
"1","               37.087 seconds (Sampling)"
"1","
"
"1","Chain "
"1","1"
"1",": "
"1","               174.038 seconds (Total)"
"1","
"
"1","Chain "
"1","1"
"1",": "
"1",""
"1","
"
"1","
"
"1",""
"1","SAMPLING"
"1",""
"1"," FOR MODEL '"
"1",""
"1","anon_model"
"1",""
"1","' NOW (CHAIN "
"1",""
"1","2"
"1",""
"1",").
"
"1","Chain "
"1","2"
"1",": "
"1",""
"1","
"
"1","Chain "
"1","2"
"1",": "
"1","Gradient evaluation took 0.000607 seconds"
"1","
"
"1","Chain "
"1","2"
"1",": "
"1","1000 transitions using 10 leapfrog steps per transition would take 6.07 seconds."
"1","
"
"1","Chain "
"1","2"
"1",": "
"1","Adjust your expectations accordingly!"
"1","
"
"1","Chain "
"1","2"
"1",": "
"1",""
"1","
"
"1","Chain "
"1","2"
"1",": "
"1",""
"1","
"
"1","Chain "
"1","2"
"1",": "
"1","Iteration:    1 / 2000 [  0%]  (Warmup)"
"1","
"
"1","Chain "
"1","2"
"1",": "
"1","Iteration:  200 / 2000 [ 10%]  (Warmup)"
"1","
"
"1","Chain "
"1","2"
"1",": "
"1","Iteration:  400 / 2000 [ 20%]  (Warmup)"
"1","
"
"1","Chain "
"1","2"
"1",": "
"1","Iteration:  600 / 2000 [ 30%]  (Warmup)"
"1","
"
"1","Chain "
"1","2"
"1",": "
"1","Iteration:  800 / 2000 [ 40%]  (Warmup)"
"1","
"
"1","Chain "
"1","2"
"1",": "
"1","Iteration: 1000 / 2000 [ 50%]  (Warmup)"
"1","
"
"1","Chain "
"1","2"
"1",": "
"1","Iteration: 1001 / 2000 [ 50%]  (Sampling)"
"1","
"
"1","Chain "
"1","2"
"1",": "
"1","Iteration: 1200 / 2000 [ 60%]  (Sampling)"
"1","
"
"1","Chain "
"1","2"
"1",": "
"1","Iteration: 1400 / 2000 [ 70%]  (Sampling)"
"1","
"
"1","Chain "
"1","2"
"1",": "
"1","Iteration: 1600 / 2000 [ 80%]  (Sampling)"
"1","
"
"1","Chain "
"1","2"
"1",": "
"1","Iteration: 1800 / 2000 [ 90%]  (Sampling)"
"1","
"
"1","Chain "
"1","2"
"1",": "
"1","Iteration: 2000 / 2000 [100%]  (Sampling)"
"1","
"
"1","Chain "
"1","2"
"1",": "
"1",""
"1","
"
"1","Chain "
"1","2"
"1",": "
"1"," Elapsed Time: 128.172 seconds (Warm-up)"
"1","
"
"1","Chain "
"1","2"
"1",": "
"1","               43.26 seconds (Sampling)"
"1","
"
"1","Chain "
"1","2"
"1",": "
"1","               171.432 seconds (Total)"
"1","
"
"1","Chain "
"1","2"
"1",": "
"1",""
"1","
"
"2","警告： There were 16 divergent transitions after warmup. See
https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup
to find out why this is a problem and how to eliminate them."
"2","警告： Examine the pairs() plot to diagnose sampling problems
"
"0","summary(bayes_model)"
"2","警告： There were 16 divergent transitions after warmup. Increasing adapt_delta above 0.95 may help. See http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup"
"1"," Family: "
"1","bernoulli"
"1"," "
"1","
"
"1","  Links: "
"1","mu = logit"
"1"," "
"1","
"
"1","Formula: "
"1","eyeDetection ~ Channel1 + Channel2 + Channel3 + Channel4 + Channel5 + Channel6 + Channel7 + Channel8 + Channel9 + Channel10 + Channel11 + Channel12 + Channel13 + Channel14"
"1"," "
"1","
"
"1","   Data: data_selected[, c(selected_channels, ""eyeDetection (Number of observations: 14980) 
"
"1","  Draws: 2 chains, each with iter = 2000; warmup = 1000; thin = 1;
         total post-warmup draws = 2000
"
"1","
"
"1","Regression Coefficients:
"
"1","         "
"1"," Estimate"
"1"," Est.Error"
"1"," l-95% CI"
"1"," u-95% CI"
"1"," Rhat"
"1"," Bulk_ESS"
"1"," Tail_ESS"
"1","
Intercept"
"1","    -1.03"
"1","      0.14"
"1","    -1.31"
"1","    -0.76"
"1"," 1.00"
"1","     1094"
"1","     1354"
"1","
Channel1 "
"1","    16.24"
"1","      4.86"
"1","     6.64"
"1","    25.50"
"1"," 1.00"
"1","     1399"
"1","     1485"
"1","
Channel2 "
"1","    -0.91"
"1","      0.05"
"1","    -1.00"
"1","    -0.82"
"1"," 1.00"
"1","     2103"
"1","     1666"
"1","
Channel3 "
"1","     0.62"
"1","      0.10"
"1","     0.44"
"1","     0.81"
"1"," 1.00"
"1","     1836"
"1","     1473"
"1","
Channel4 "
"1","   -56.76"
"1","      9.10"
"1","   -74.18"
"1","   -38.35"
"1"," 1.00"
"1","     1670"
"1","     1500"
"1","
Channel5 "
"1","     1.33"
"1","      0.08"
"1","     1.17"
"1","     1.50"
"1"," 1.00"
"1","     1433"
"1","     1409"
"1","
Channel6 "
"1","  -120.35"
"1","      5.95"
"1","  -132.14"
"1","  -108.47"
"1"," 1.00"
"1","     2032"
"1","     1632"
"1","
Channel7 "
"1","    17.07"
"1","      5.88"
"1","     5.88"
"1","    28.64"
"1"," 1.00"
"1","     1917"
"1","     1815"
"1","
Channel8 "
"1","    -0.00"
"1","      0.06"
"1","    -0.13"
"1","     0.11"
"1"," 1.00"
"1","     2082"
"1","     1480"
"1","
Channel9 "
"1","    11.97"
"1","      5.36"
"1","     1.40"
"1","    22.53"
"1"," 1.00"
"1","     1861"
"1","     1542"
"1","
Channel10"
"1","     0.18"
"1","      0.08"
"1","     0.02"
"1","     0.34"
"1"," 1.00"
"1","     2156"
"1","     1578"
"1","
Channel11"
"1","    -0.37"
"1","      0.06"
"1","    -0.49"
"1","    -0.25"
"1"," 1.00"
"1","     2299"
"1","     1485"
"1","
Channel12"
"1","     0.26"
"1","      0.11"
"1","     0.04"
"1","     0.49"
"1"," 1.00"
"1","     1914"
"1","     1595"
"1","
Channel13"
"1","    -1.86"
"1","      1.69"
"1","    -5.21"
"1","     1.30"
"1"," 1.00"
"1","     2273"
"1","     1557"
"1","
Channel14"
"1","    30.59"
"1","     12.19"
"1","     6.54"
"1","    54.59"
"1"," 1.00"
"1","     1308"
"1","     1459"
"1","
"
"1","
"
"1","Draws were sampled using sampling(NUTS). "
"1","For each parameter, Bulk_ESS
and Tail_ESS are effective sample size measures, and Rhat is the potential
scale reduction factor on split chains (at convergence, Rhat = 1)."
"1","
"
"0","# 5. Model Diagnostics - Residuals Analysis"
"0","# Residuals for logistic model"
"0","residuals_log <- residuals(log_model, type = ""deviance"")"
"0","plot(fitted(log_model), residuals_log, main = ""Residuals vs Fitted (Logistic)"","
"0","     xlab = ""Fitted Values"", ylab = ""Deviance Residuals"")"
