"0","# 檢查並設置工作目錄"
"0","if (!dir.exists(""output"")) {"
"0","  dir.create(""output"")"
"0","}"
"0","setwd(""output"")"
"0","cat(""Current working directory:"", getwd(), ""\n"")"
"1","Current working directory:"
"1"," "
"1","C:/Users/Charles/OneDrive/桌面/Final Project/output"
"1"," "
"1","
"
"0","# 準備數據"
"0","features <- train_data %>% dplyr::select(-eye_detection)"
"0","X <- as.matrix(features)"
"0","y <- train_data$eye_detection"
"0",""
"0","# 標準化特徵"
"0","X_scaled <- scale(X)"
"0",""
"0","# LASSO 變數選擇"
"0","set.seed(1754)"
"0","lasso_model <- cv.glmnet(X_scaled, y, family = ""binomial"", alpha = 1)"
"0","best_lambda <- lasso_model$lambda.1se"
"0",""
"0","# 提取非零係數的變數"
"0","lasso_coefs <- coef(lasso_model, s = ""lambda.1se"")"
"0","lasso_coef_df <- as.data.frame(as.matrix(lasso_coefs)) %>%"
"0","  tibble::rownames_to_column(""Variable"") %>%"
"0","  dplyr::filter(s1 != 0, Variable != ""(Intercept)"") %>%"
"0","  dplyr::rename(Coefficient = s1)"
"0",""
"0","# 顯示結果"
"0","cat(""LASSO Selected Variables:\n"")"
"1","LASSO Selected Variables:
"
"0","print(lasso_coef_df$Variable)"
"1"," [1]"
"1"," ""af3""                "
"1"," ""f7""                 "
"1"," ""f3""                 "
"1"," ""t7""                 "
"1"," ""p7""                 "
"1"," ""o1""                 "
"1","
"
"1"," [7]"
"1"," ""p8""                 "
"1"," ""af4""                "
"1"," ""window_start""       "
"1"," ""fft_delta_power_af3"""
"1"," ""fft_delta_power_f7"" "
"1"," ""fft_delta_power_fc5"""
"1","
"
"1","[13]"
"1"," ""fft_delta_power_o1"" "
"1"," ""fft_delta_power_p8"" "
"1"," ""fft_delta_power_f4"" "
"1"," ""fft_theta_power_af3"""
"1"," ""fft_theta_power_fc5"""
"1"," ""fft_theta_power_p7"" "
"1","
"
"1","[19]"
"1"," ""fft_theta_power_o1"" "
"1"," ""fft_theta_power_o2"" "
"1"," ""fft_theta_power_t8"" "
"1"," ""fft_theta_power_f4"" "
"1"," ""fft_theta_power_f8"" "
"1"," ""fft_theta_power_af4"""
"1","
"
"1","[25]"
"1"," ""fft_alpha_power_f7"" "
"1"," ""fft_alpha_power_f3"" "
"1"," ""fft_alpha_power_fc5"""
"1"," ""fft_alpha_power_t7"" "
"1"," ""fft_alpha_power_p7"" "
"1"," ""fft_alpha_power_o1"" "
"1","
"
"1","[31]"
"1"," ""fft_alpha_power_p8"" "
"1"," ""fft_alpha_power_t8"" "
"1"," ""fft_alpha_power_fc6"""
"1"," ""fft_beta_power_af3"" "
"1"," ""fft_beta_power_f7""  "
"1"," ""fft_beta_power_p7""  "
"1","
"
"1","[37]"
"1"," ""fft_beta_power_o1""  "
"1"," ""fft_beta_power_o2""  "
"1"," ""fft_beta_power_p8""  "
"1"," ""fft_beta_power_t8""  "
"1"," ""fft_beta_power_fc6"" "
"1"," ""fft_beta_power_af4"" "
"1","
"
"1","[43]"
"1"," ""fft_gamma_power_t7"" "
"1"," ""fft_gamma_power_p7"" "
"1"," ""fft_gamma_power_p8"" "
"1"," ""fft_gamma_power_t8"" "
"1"," ""fft_gamma_power_fc6"""
"1"," ""fft_gamma_power_af4"""
"1","
"
"1","[49]"
"1"," ""af3_2""              "
"1"," ""f7_2""               "
"1"," ""fc5_2""              "
"1"," ""t7_2""               "
"1"," ""o1_2""               "
"1"," ""o2_2""               "
"1","
"
"1","[55]"
"1"," ""p8_2""               "
"1"," ""f4_2""               "
"1"," ""f8_2""               "
"1","
"
"0","# 繪製係數圖"
"0","lasso_coef_plot <- ggplot(lasso_coef_df, aes(x = reorder(Variable, abs(Coefficient)), y = Coefficient)) +"
"0","  geom_bar(stat = ""identity"", fill = ""skyblue"") +"
"0","  coord_flip() +"
"0","  theme_minimal() +"
"0","  labs(title = ""LASSO Selected Variables Coefficients"", x = ""Variable"", y = ""Coefficient"")+"
"0","  theme("
"0","    axis.text.y = element_text(size = 4, hjust = 1, margin = unit(c(0, 5, 0, 0), ""pt"")), "
"0","    axis.text.x = element_text(size = 10),"
"0","    plot.title = element_text(size = 12, hjust = 0.5),"
"0","    plot.margin = unit(c(10, 20, 10, 20), ""pt"") # 增加圖表邊距"
"0","  )"
"0",""
"0",""
"0","best_lambda"
"1","[1]"
"1"," 0.006662954"
"1","
"
"0","print(lasso_coef_df)"
