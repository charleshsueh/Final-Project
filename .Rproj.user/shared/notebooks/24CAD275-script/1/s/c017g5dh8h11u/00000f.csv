"0","data_features <- data_reduced %>%"
"0","  mutate("
"0","    AF_diff = AF3 - AF4,"
"0","    O_diff = O1 - O2,"
"0","    AF3_O1_interaction = AF3 * O1,"
"0","    alpha_O1_alpha_AF3_diff = fft_alpha_power_O1 - fft_alpha_power_AF3,"
"0","    beta_alpha_ratio_FC5 = fft_beta_power_FC5 / (fft_alpha_power_FC5 + 1e-10)"
"0","  ) %>%"
"0","  na.omit()"
"0",""
"0","# 檢查特徵與目標變量的相關性"
"0","cor_with_target <- data_features %>%"
"0","  select(-eyeDetection) %>%"
"0","  summarise_all(~ cor(., as.numeric(data_features$eyeDetection), use = ""complete.obs"")) %>%"
"0","  pivot_longer(everything(), names_to = ""Feature"", values_to = ""Correlation"")"
"0",""
"0","# 檢查 cor_with_target 是否正確生成"
"0","print(""Structure of cor_with_target:"")"
"1","[1]"
"1"," ""Structure of cor_with_target:"""
"1","
"
"0","str(cor_with_target)"
"1","tibble [90 × 2]"
"1",""
"1"," (S3: "
"1",""
"1","tbl_df/tbl/data.frame"
"1",""
"1",")"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Feature    "
"1",""
"1",":"
"1"," chr [1:90] "
"1",""
"1","""AF3"" ""F7"" ""F3"" ""FC5"""
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Correlation"
"1",""
"1",":"
"1"," num [1:90] "
"1",""
"1","0.1295 -0.11163 0.0796 -0.04076 -0.00145"
"1",""
"1"," ..."
"1",""
"1","
"
"0","# 使用 dplyr::filter 過濾高相關性特徵"
"0","high_cor_features <- cor_with_target %>%"
"0","  dplyr::filter(abs(Correlation) > 0.9) %>%"
"0","  pull(Feature)"
"0",""
"0","if (length(high_cor_features) > 0) {"
"0","  cat(""Removing features with high correlation to target:"", high_cor_features, ""\n"")"
"0","  data_features <- data_features %>% select(-all_of(high_cor_features))"
"0","} else {"
"0","  cat(""No features with high correlation to target (abs(Correlation) > 0.9) found.\n"")"
"0","}"
"1","No features with high correlation to target (abs(Correlation) > 0.9) found.
"
