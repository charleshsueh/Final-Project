"0","# 確保數據完整性"
"0","cat(""Checking for NA in train_data_selected:\n"")"
"1","Checking for NA in train_data_selected:
"
"0","print(any(is.na(train_data_selected)))"
"1","[1]"
"1"," FALSE"
"1","
"
"0","cat(""Checking for NA in test_data_selected:\n"")"
"1","Checking for NA in test_data_selected:
"
"0","print(any(is.na(test_data_selected)))"
"1","[1]"
"1"," FALSE"
"1","
"
"0","# 訓練邏輯回歸模型"
"0","logistic_model <- glm(eye_detection ~ ., data = train_data_selected, family = ""binomial"")"
"0",""
"0","# 打印模型摘要"
"0","summary_logistic <- summary(logistic_model)"
"0","print(summary_logistic)"
"1","
Call:
"
"1",""
"1","glm(formula = eye_detection ~ ., family = ""binomial"", data = train_data_selected)"
"1",""
"1","
"
"1","
Coefficients:
"
"1","                   "
"1","   Estimate"
"1"," Std. Error"
"1"," z value"
"1"," Pr(>|z|)"
"1","    "
"1","
(Intercept)        "
"1","  2.168e+00"
"1","  3.302e-01"
"1","   6.564"
"1"," 5.22e-11"
"1"," ***"
"1","
window_start       "
"1"," -9.207e-05"
"1","  2.887e-05"
"1","  -3.189"
"1"," 0.001426"
"1"," ** "
"1","
fft_beta_power_p8  "
"1"," -1.698e+01"
"1","  8.214e+00"
"1","  -2.068"
"1"," 0.038663"
"1"," *  "
"1","
fft_delta_power_o1 "
"1"," -2.114e+00"
"1","  1.200e+00"
"1","  -1.762"
"1"," 0.078122"
"1"," .  "
"1","
fft_beta_power_o1  "
"1"," -2.555e+01"
"1","  1.861e+01"
"1","  -1.373"
"1"," 0.169768"
"1","    "
"1","
fft_gamma_power_p8 "
"1"," -2.275e+01"
"1","  4.741e+01"
"1","  -0.480"
"1"," 0.631370"
"1","    "
"1","
p7                 "
"1"," -7.296e-01"
"1","  2.653e-01"
"1","  -2.750"
"1"," 0.005951"
"1"," ** "
"1","
fft_theta_power_o1 "
"1","  1.140e+01"
"1","  3.380e+00"
"1","   3.372"
"1"," 0.000747"
"1"," ***"
"1","
o1                 "
"1","  3.095e-01"
"1","  1.590e-01"
"1","   1.946"
"1"," 0.051646"
"1"," .  "
"1","
af4                "
"1","  1.531e-01"
"1","  4.596e-01"
"1","   0.333"
"1"," 0.739042"
"1","    "
"1","
af3                "
"1","  7.098e-01"
"1","  5.321e-01"
"1","   1.334"
"1"," 0.182217"
"1","    "
"1","
fft_alpha_power_p7 "
"1","  3.851e-01"
"1","  6.246e+00"
"1","   0.062"
"1"," 0.950833"
"1","    "
"1","
fft_beta_power_t8  "
"1"," -2.272e+01"
"1","  9.655e+00"
"1","  -2.353"
"1"," 0.018628"
"1"," *  "
"1","
fft_beta_power_o2  "
"1"," -1.865e+01"
"1","  6.093e+00"
"1","  -3.060"
"1"," 0.002214"
"1"," ** "
"1","
fft_alpha_power_p8 "
"1"," -9.080e+00"
"1","  3.020e+00"
"1","  -3.007"
"1"," 0.002640"
"1"," ** "
"1","
fft_alpha_power_o1 "
"1"," -2.581e+01"
"1","  7.988e+00"
"1","  -3.232"
"1"," 0.001231"
"1"," ** "
"1","
fft_gamma_power_t7 "
"1"," -2.376e+02"
"1","  6.720e+01"
"1","  -3.536"
"1"," 0.000406"
"1"," ***"
"1","
f7                 "
"1"," -1.093e+00"
"1","  2.357e-01"
"1","  -4.636"
"1"," 3.56e-06"
"1"," ***"
"1","
fft_beta_power_af3 "
"1"," -3.235e+01"
"1","  1.119e+01"
"1","  -2.892"
"1"," 0.003832"
"1"," ** "
"1","
fft_gamma_power_p7 "
"1"," -7.564e+01"
"1","  6.088e+01"
"1","  -1.242"
"1"," 0.214067"
"1","    "
"1","
fft_delta_power_p8 "
"1"," -7.157e-01"
"1","  1.115e+00"
"1","  -0.642"
"1"," 0.521043"
"1","    "
"1","
fft_theta_power_f4 "
"1","  1.058e+01"
"1","  2.470e+00"
"1","   4.285"
"1"," 1.83e-05"
"1"," ***"
"1","
p8                 "
"1","  1.391e-01"
"1","  1.996e-01"
"1","   0.697"
"1"," 0.486048"
"1","    "
"1","
fft_theta_power_p7 "
"1"," -4.955e-01"
"1","  3.670e+00"
"1","  -0.135"
"1"," 0.892600"
"1","    "
"1","
fft_alpha_power_t7 "
"1","  1.675e+01"
"1","  5.539e+00"
"1","   3.025"
"1"," 0.002489"
"1"," ** "
"1","
o1_2               "
"1","  1.676e-01"
"1","  1.543e-01"
"1","   1.086"
"1"," 0.277433"
"1","    "
"1","
fft_alpha_power_t8 "
"1","  1.037e+01"
"1","  3.422e+00"
"1","   3.030"
"1"," 0.002445"
"1"," ** "
"1","
f3                 "
"1","  1.718e-01"
"1","  2.401e-01"
"1","   0.715"
"1"," 0.474302"
"1","    "
"1","
fft_alpha_power_fc6"
"1","  5.252e+00"
"1","  2.635e+00"
"1","   1.993"
"1"," 0.046245"
"1"," *  "
"1","
fft_delta_power_f4 "
"1"," -8.963e-02"
"1","  9.339e-01"
"1","  -0.096"
"1"," 0.923541"
"1","    "
"1","
fft_alpha_power_f3 "
"1","  6.024e+00"
"1","  3.296e+00"
"1","   1.828"
"1"," 0.067594"
"1"," .  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
(Dispersion parameter for "
"1",""
"1","binomial"
"1",""
"1"," family taken to be "
"1",""
"1","1"
"1",""
"1",")

"
"1",""
"1","    Null deviance: 1131.22  on 815  degrees of freedom
"
"1",""
"1","Residual deviance:  780.38  on 785  degrees of freedom
"
"1","AIC: "
"1",""
"1","842.38"
"1",""
"1","

"
"1",""
"1","Number of Fisher Scoring iterations: "
"1",""
"1","6"
"1",""
"1","
"
"1","
"
"0","# 訓練集預測與準確度"
"0","train_prob_logistic <- predict(logistic_model, newdata = train_data_selected, type = ""response"")"
"0","train_predicted_classes_logistic <- ifelse(train_prob_logistic > 0.5, 1, 0) %>% as.factor()"
"0","levels(train_predicted_classes_logistic) <- levels(train_data_selected$eye_detection)"
"0","train_accuracy_logistic <- mean(train_predicted_classes_logistic == train_data_selected$eye_detection)"
"0","cat(""Logistic Regression Training Accuracy:"", train_accuracy_logistic, ""\n"")"
"1","Logistic Regression Training Accuracy:"
"1"," "
"1","0.7573529"
"1"," "
"1","
"
"0","# 測試集預測與準確度"
"0","test_prob_logistic <- predict(logistic_model, newdata = test_data_selected, type = ""response"")"
"0","test_predicted_classes_logistic <- ifelse(test_prob_logistic > 0.5, 1, 0) %>% as.factor()"
"0","levels(test_predicted_classes_logistic) <- levels(test_data_selected$eye_detection)"
"0","test_accuracy_logistic <- mean(test_predicted_classes_logistic == test_data_selected$eye_detection)"
"0","cat(""Logistic Regression Test Accuracy:"", test_accuracy_logistic, ""\n"")"
"1","Logistic Regression Test Accuracy:"
"1"," "
"1","0.75"
"1"," "
"1","
"
"0","# 混淆矩陣"
"0","conf_matrix_logistic <- confusionMatrix(test_predicted_classes_logistic, test_data_selected$eye_detection)"
"0","print(conf_matrix_logistic)"
"1","Confusion Matrix and Statistics

"
"1","          Reference
"
"1","Prediction"
"1","  0"
"1","  1"
"1","
         0"
"1"," 72"
"1"," 21"
"1","
         1"
"1"," 30"
"1"," 81"
"1","
"
"1",""
"1","                         "
"1","                 "
"1","
"
"1","               Accuracy :"
"1"," 0.75            "
"1","
"
"1","                 95% CI :"
"1"," (0.6847, 0.8078)"
"1","
"
"1","    No Information Rate :"
"1"," 0.5             "
"1","
"
"1","    P-Value [Acc > NIR] :"
"1"," 2.463e-13       "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","                  Kappa :"
"1"," 0.5             "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1"," Mcnemar's Test P-Value :"
"1"," 0.2626          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","            Sensitivity :"
"1"," 0.7059          "
"1","
"
"1","            Specificity :"
"1"," 0.7941          "
"1","
"
"1","         Pos Pred Value :"
"1"," 0.7742          "
"1","
"
"1","         Neg Pred Value :"
"1"," 0.7297          "
"1","
"
"1","             Prevalence :"
"1"," 0.5000          "
"1","
"
"1","         Detection Rate :"
"1"," 0.3529          "
"1","
"
"1","   Detection Prevalence :"
"1"," 0.4559          "
"1","
"
"1","      Balanced Accuracy :"
"1"," 0.7500          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","       'Positive' Class :"
"1"," 0               "
"1","
"
"1","                         "
"1","                 "
"1","
"
"0","# ROC 和 AUC"
"0","roc_logistic <- roc(as.numeric(test_data_selected$eye_detection) - 1, test_prob_logistic)"
"0","auc_logistic <- auc(roc_logistic)"
"0","cat(""Logistic Regression AUC:"", auc_logistic, ""\n"")"
"1","Logistic Regression AUC:"
"1"," "
"1","0.8217993"
"1"," "
"1","
"
