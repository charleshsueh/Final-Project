"0","# Load required packages"
"0",""
"0","library(glmnet)"
"0","library(tidyr)"
"0","library(readr)"
"0","library(ggplot2)"
"0","library(dplyr)"
"0","library(stats)"
"0","library(brms)"
"0","library(lme4)"
"0","library(foreign)      "
"0","library(tidyverse)   "
"0","library(here)"
"0","library(mgcv)"
"0","library(ds4ling)"
"0",""
"0","# 步驟 1: 讀取 ARFF 檔案並整理為 TIDY Data"
"0","data <- read.arff(here(""data"",""eye_state.arff"")) # 替換為實際檔案路徑"
"0",""
"0","# Check for missing values and basic structure"
"0","print(summary(data))"
"1",""
"1","      AF3        "
"1","       F7      "
"1","       F3      "
"1","      FC5        "
"1","       T7      "
"1","
"
"1"," Min.   :  1031  "
"1"," Min.   :2831  "
"1"," Min.   :1040  "
"1"," Min.   :  2453  "
"1"," Min.   :2090  "
"1","
"
"1"," 1st Qu.:  4281  "
"1"," 1st Qu.:3991  "
"1"," 1st Qu.:4250  "
"1"," 1st Qu.:  4108  "
"1"," 1st Qu.:4332  "
"1","
"
"1"," Median :  4294  "
"1"," Median :4006  "
"1"," Median :4263  "
"1"," Median :  4120  "
"1"," Median :4339  "
"1","
"
"1"," Mean   :  4322  "
"1"," Mean   :4010  "
"1"," Mean   :4264  "
"1"," Mean   :  4165  "
"1"," Mean   :4342  "
"1","
"
"1"," 3rd Qu.:  4312  "
"1"," 3rd Qu.:4023  "
"1"," 3rd Qu.:4271  "
"1"," 3rd Qu.:  4132  "
"1"," 3rd Qu.:4347  "
"1","
"
"1"," Max.   :309231  "
"1"," Max.   :7805  "
"1"," Max.   :6881  "
"1"," Max.   :642564  "
"1"," Max.   :6474  "
"1","
"
"1",""
"1","       P7        "
"1","       O1        "
"1","       O2      "
"1","       P8        "
"1","       T8      "
"1","
"
"1"," Min.   :  2768  "
"1"," Min.   :  2086  "
"1"," Min.   :4567  "
"1"," Min.   :  1358  "
"1"," Min.   :1816  "
"1","
"
"1"," 1st Qu.:  4612  "
"1"," 1st Qu.:  4058  "
"1"," 1st Qu.:4605  "
"1"," 1st Qu.:  4191  "
"1"," 1st Qu.:4221  "
"1","
"
"1"," Median :  4618  "
"1"," Median :  4070  "
"1"," Median :4613  "
"1"," Median :  4199  "
"1"," Median :4229  "
"1","
"
"1"," Mean   :  4644  "
"1"," Mean   :  4110  "
"1"," Mean   :4616  "
"1"," Mean   :  4219  "
"1"," Mean   :4231  "
"1","
"
"1"," 3rd Qu.:  4627  "
"1"," 3rd Qu.:  4084  "
"1"," 3rd Qu.:4624  "
"1"," 3rd Qu.:  4209  "
"1"," 3rd Qu.:4239  "
"1","
"
"1"," Max.   :362564  "
"1"," Max.   :567179  "
"1"," Max.   :7264  "
"1"," Max.   :265641  "
"1"," Max.   :6674  "
"1","
"
"1",""
"1","      FC6      "
"1","       F4      "
"1","       F8           "
"1","      AF4        "
"1"," eyeDetection"
"1","
"
"1"," Min.   :3273  "
"1"," Min.   :2258  "
"1"," Min.   :    86.67  "
"1"," Min.   :  1366  "
"1"," 0:8257      "
"1","
"
"1"," 1st Qu.:4190  "
"1"," 1st Qu.:4268  "
"1"," 1st Qu.:  4590.77  "
"1"," 1st Qu.:  4342  "
"1"," 1:6723      "
"1","
"
"1"," Median :4201  "
"1"," Median :4277  "
"1"," Median :  4603.08  "
"1"," Median :  4355  "
"1","             "
"1","
"
"1"," Mean   :4202  "
"1"," Mean   :4279  "
"1"," Mean   :  4615.21  "
"1"," Mean   :  4416  "
"1","             "
"1","
"
"1"," 3rd Qu.:4211  "
"1"," 3rd Qu.:4287  "
"1"," 3rd Qu.:  4617.44  "
"1"," 3rd Qu.:  4373  "
"1","             "
"1","
"
"1"," Max.   :6823  "
"1"," Max.   :7003  "
"1"," Max.   :152308.00  "
"1"," Max.   :715897  "
"1","             "
"1","
"
"0","anyNA(data)  # Check for NA values"
"1","[1]"
"1"," FALSE"
"1","
"
"0","# Rename columns for clarity"
"0","colnames(data) <- c(paste0(""Channel"", 1:14), ""eyeDetection"")"
"0",""
"0","# Convert eyeDetection to factor and create a numeric version for LASSO"
"0","data$eyeDetection <- factor(data$eyeDetection, levels = c(0, 1), labels = c(""Closed"", ""Open""))"
"0","data$eyeDetection_numeric <- as.numeric(data$eyeDetection) - 1  # 0 for Closed, 1 for Open"
"0",""
"0","# Standardize the predictor variables to improve model convergence"
"0","data[, 1:14] <- scale(data[, 1:14])"
"0",""
"0","# Prepare data matrix for LASSO (predictors and response)"
"0","x <- as.matrix(data[, 1:14])  # Predictor variables (channels)"
"0","y <- data$eyeDetection_numeric  # Response variable"
"0",""
"0","# 2. LASSO Variable Selection"
"0","# Perform LASSO regression"
"0","lasso_model <- cv.glmnet(x, y, family = ""binomial"", alpha = 1, nfolds = 10)"
"2","警告： from glmnet C++ code (error code -45); Convergence for 45th lambda value not reached after maxit=100000 iterations; solutions for larger lambdas returned"
"0","# Extract coefficients at the optimal lambda"
"0","coef_lasso <- coef(lasso_model, s = ""lambda.min"")"
"0","selected_vars <- coef_lasso@Dimnames[[1]][which(coef_lasso != 0)]  # Variables with non-zero coefficients"
"0","print(""Selected variables by LASSO:"")"
"1","[1]"
"1"," ""Selected variables by LASSO:"""
"1","
"
"0","print(selected_vars)"
"1"," [1]"
"1"," ""(Intercept)"""
"1"," ""Channel1""   "
"1"," ""Channel2""   "
"1"," ""Channel3""   "
"1"," ""Channel4""   "
"1","
"
"1"," [6]"
"1"," ""Channel5""   "
"1"," ""Channel6""   "
"1"," ""Channel7""   "
"1"," ""Channel8""   "
"1"," ""Channel9""   "
"1","
"
"1","[11]"
"1"," ""Channel10""  "
"1"," ""Channel11""  "
"1"," ""Channel12""  "
"1"," ""Channel13""  "
"1"," ""Channel14""  "
"1","
"
"0","# Plot LASSO coefficient path"
"0","plot(lasso_model, main = ""LASSO Coefficient Path"")"
